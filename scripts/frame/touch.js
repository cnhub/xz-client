//origin Zepto touch.js
(function(g){function v(a,c,d,f){return Math.abs(a-c)>=Math.abs(d-f)?0<a-c?"Left":"Right":0<d-f?"Up":"Down"}function w(){c=null;a.last&&(a.el.trigger("longTap"),a={})}function r(){d&&clearTimeout(d);m&&clearTimeout(m);n&&clearTimeout(n);c&&clearTimeout(c);d=m=n=c=null;a={}}function t(a){return("touch"==a.pointerType||a.pointerType==a.MSPOINTER_TYPE_TOUCH)&&a.isPrimary}function u(a,c){return a.type=="pointer"+c||a.type.toLowerCase()=="mspointer"+c}var a={},d,m,n,c,p;g(document).ready(function(){var k,q,l=0,f=0,e,h;"MSGesture"in window&&(p=new MSGesture,p.target=document.body);g(document).bind("MSGestureEnd",function(b){if(b=1<b.velocityX?"Right":-1>b.velocityX?"Left":1<b.velocityY?"Down":-1>b.velocityY?"Up":null)a.el.trigger("swipe"),a.el.trigger("swipe"+b)}).on("touchstart MSPointerDown pointerdown",function(b){if(!(h=u(b,"down"))||t(b))e=h?b:b.originalEvent.touches[0],b.originalEvent.touches&&1===b.originalEvent.touches.length&&a.x2&&(a.x2=void 0,a.y2=void 0),k=Date.now(),q=k-(a.last||k),a.el=g("tagName"in e.target?e.target:e.target.parentNode),d&&clearTimeout(d),a.x1=e.pageX,a.y1=e.pageY,0<q&&250>=q&&(a.isDoubleTap=!0),a.last=k,c=setTimeout(w,750),p&&h&&p.addPointer(b.pointerId)}).on("touchmove MSPointerMove pointermove",function(b){if(!(h=u(b,"move"))||t(b))e=h?b:b.originalEvent.touches[0],c&&clearTimeout(c),c=null,a.x2=e.pageX,a.y2=e.pageY,l+=Math.abs(a.x1-a.x2),f+=Math.abs(a.y1-a.y2)}).on("touchend MSPointerUp pointerup",function(b){if(!(h=u(b,"up"))||t(b))c&&clearTimeout(c),c=null,a.x2&&30<Math.abs(a.x1-a.x2)||a.y2&&30<Math.abs(a.y1-a.y2)?n=setTimeout(function(){a.el.trigger("swipe");a.el.trigger("swipe"+v(a.x1,a.x2,a.y1,a.y2));a={}},0):"last"in a&&(30>l&&30>f?m=setTimeout(function(){var b=g.Event("tap");b.cancelTouch=r;a.el.trigger(b);a.isDoubleTap?(a.el&&a.el.trigger("doubleTap"),a={}):d=setTimeout(function(){d=null;a.el&&a.el.trigger("singleTap");a={}},250)},0):a={}),l=f=0}).on("touchcancel MSPointerCancel pointercancel",r);g(window).on("scroll",r)});"swipe swipeLeft swipeRight swipeUp swipeDown doubleTap tap singleTap longTap".split(" ").forEach(function(a){g.fn[a]=function(c){return this.on(a,c)}})})($);